div align="center">

# nemig_nrs

<a href="https://pytorch.org/get-started/locally/"><img alt="PyTorch" src="https://img.shields.io/badge/PyTorch-ee4c2c?logo=pytorch&logoColor=white"></a>
<a href="https://pytorchlightning.ai/"><img alt="Lightning" src="https://img.shields.io/badge/-Lightning-792ee5?logo=pytorchlightning&logoColor=white"></a>
<a href="https://hydra.cc/"><img alt="Config: Hydra" src="https://img.shields.io/badge/Config-Hydra-89b8cd"></a>
<a href="https://github.com/ashleve/lightning-hydra-template"><img alt="Template" src="https://img.shields.io/badge/-Lightning--Hydra--Template-017F2F?style=flat&logo=github&labelColor=gray"></a><br>

</div>

# Description

This is the code for benchmarking different neural news recommenders on the [NeMig](https://doi.org/10.5281/zenodo.7442424) dataset.

## Project Structure

The directory structure of the project looks like this:

```
├── configs                   <- Hydra configuration files
│   ├── callbacks                <- Callbacks configs
│   ├── datamodule               <- Datamodule configs
│   ├── debug                    <- Debugging configs
│   ├── experiment               <- Experiment configs
│   ├── extras                   <- Extra utilities configs
│   ├── hparams_search           <- Hyperparameter search configs
│   ├── hydra                    <- Hydra configs
│   ├── local                    <- Local configs
│   ├── logger                   <- Logger configs
│   ├── model                    <- Model configs
│   ├── paths                    <- Project paths configs
│   ├── trainer                  <- Trainer configs
│   │
│   ├── eval.yaml             <- Main config for evaluation
│   └── train.yaml            <- Main config for training
│
├── data                   <- Project data
│
├── logs                   <- Logs generated by hydra and lightning loggers
│
├── scripts                <- Shell scripts
│
├── src                    <- Source code
│   ├── datamodules              <- Lightning datamodules
│   ├── models                   <- Lightning models
|   ├── metrics                  <- Custom evaluation metrics 
│   ├── utils                    <- Utility scripts
│   │
│   ├── eval.py                  <- Run evaluation
│   └── train.py                 <- Run training
│
├── .gitignore                <- List of files ignored by git
├── requirements.txt          <- File for installing python dependencies
├── setup.py                  <- File for installing project as a package
└── README.md
```

## Data
We use the [NeMig](https://doi.org/10.5281/zenodo.7442424) dataset in all experiments. <br>
The news and user data can be found in the [data](data/) folder, along with a description of the files. <br>
The knowledge graph files can be downloaded from [Zenodo](https://doi.org/10.5281/zenodo.7442424).

## How to run

Install dependencies

```bash
# clone project
git clone git@github.com:andreeaiana/nemig_nrs.git
cd nemig_nrs

# [OPTIONAL] create conda environment
conda create -n nemig_nrs_env python=3.9
conda activate nemig_nrs_env

# install pytorch according to instructions
# https://pytorch.org/get-started/

# install requirements
pip install -r requirements.txt
```

Download the language-specific GloVe embeddings as follows
- for the German NeMig from [Deepset](https://www.deepset.ai/german-word-embeddings) and store them in the [German glove folder](data/glove/de/)
- for the English NeMig from [GloVe](https://nlp.stanford.edu/projects/glove/) and store them in the [English glove folder](data/glove/en/)

Train model with chosen experiment configuration from [configs/experiment/](configs/experiment/)

```bash
# train on GPU
python src/train.py experiment=experiment_name.yaml trainer=gpu
```

You can override any parameter from command line like this

```bash
python src/train.py trainer.max_epochs=20 datamodule.batch_size=64
```

To run DKN with pretrained entity embeddings, first download the NeMigKG version of your choice from [Zenodo](https://doi.org/10.5281/zenodo.7442424). Next, train entity embeddings with a KGE of your choice and store them in the [German](data/de/kg/) or [English](data/en/kg/) correspding KG folder.


## License
The code is licensed under the MIT License. The data files are licensed under the [Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License](https://creativecommons.org/licenses/by-nc-sa/4.0/).

## Citation
If you use the dataset, please cite:

```
@dataset{iana_andreea_2022_7908392,
  author       = {Iana, Andreea and
                  Alam, Mehwish and
                  Grote, Alexander and
                  Nikolajevic, Nevena and
                  Ludwig, Katharina and
                  Müller, Philipp and
                  Weinhardt, Christof and
                  Paulheim, Heiko},
  title        = {{NeMig - A Bilingual News Collection and Knowledge 
                   Graph about Migration}},
  month        = dec,
  year         = 2022,
  publisher    = {Zenodo},
  version      = {v1.0.1},
  doi          = {10.5281/zenodo.7442424},
  url          = {https://doi.org/10.5281/zenodo.7442424}
}
```